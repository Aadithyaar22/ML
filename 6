# Program 6 - Naive Bayes classifier (as in notebook)
import pandas as pd
import numpy as np

# load data (file must be in same folder)
data = pd.read_csv("enjoysport.copy.csv")
df = pd.DataFrame(data)

# prior probabilities
prior_prob = df['EnjoySport'].value_counts(normalize=True).to_dict()
print("\nPrior Probabilities:\n", prior_prob)

# separate positive and negative examples
df_yes = df[df['EnjoySport'] == 'Yes']
df_no  = df[df['EnjoySport'] == 'No']

# likelihoods: for each feature get normalized value counts -> dict
likelihood_yes = {}
likelihood_no  = {}
for column in ['Outlook', 'Temperature', 'Humidity', 'Wind']:
    likelihood_yes[column] = df_yes[column].value_counts(normalize=True).to_dict()
    likelihood_no[column]  = df_no[column].value_counts(normalize=True).to_dict()

print("\nLikelihoods for EnjoySport = Yes:")
for feature, items in likelihood_yes.items():
    for value, prob in items.items():
        print(f"{feature} = {value} : {prob}")

print("\nLikelihoods for EnjoySport = No:")
for feature, items in likelihood_no.items():
    for value, prob in items.items():
        print(f"{feature} = {value} : {prob}")

# Naive Bayes classifier (returns 'Yes' or 'No')
def naive_bayes_classifier(test_instance, prior_prob, likelihood_yes, likelihood_no):
    posterior_yes = np.log(prior_prob.get('Yes', 1e-6))
    posterior_no  = np.log(prior_prob.get('No', 1e-6))

    for feature, value in test_instance.items():
        # small smoothing for unseen values (as in notebook)
        posterior_yes += np.log(likelihood_yes[feature].get(value, 1e-6))
        posterior_no  += np.log(likelihood_no[feature].get(value, 1e-6))

    print("\nPosterior (log) Yes:", posterior_yes)
    print("Posterior (log) No :", posterior_no)

    return 'Yes' if posterior_yes > posterior_no else 'No'

# test instance (as in notebook)
test_instance = {
    'Outlook': 'Sunny',
    'Temperature': 'Cool',
    'Humidity': 'Normal',
    'Wind': 'Weak'
}

prediction = naive_bayes_classifier(test_instance, prior_prob, likelihood_yes, likelihood_no)
print("\nPrediction:", prediction)
